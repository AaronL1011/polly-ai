# DemÃ³crata Environment Configuration
# Copy this file to .env and fill in values

# =============================================================================
# LLM Provider Configuration
# =============================================================================
# Supported providers: openai, ollama
LLM_PROVIDER=openai
EMBEDDING_PROVIDER=openai

# =============================================================================
# OpenAI Configuration (when LLM_PROVIDER=openai or EMBEDDING_PROVIDER=openai)
# =============================================================================
# Required when using OpenAI provider
OPENAI_API_KEY=sk-your-openai-api-key

# Optional: Custom base URL for OpenAI-compatible APIs (e.g., OpenRouter, Azure)
# OPENAI_BASE_URL=https://openrouter.ai/api/v1

# Model selection (defaults shown)
# LLM_MODEL=gpt-4o-mini
# EMBEDDING_MODEL=text-embedding-3-small
# EMBEDDING_DIMENSIONS=1536

# =============================================================================
# Ollama Configuration (when LLM_PROVIDER=ollama or EMBEDDING_PROVIDER=ollama)
# =============================================================================
# OLLAMA_BASE_URL=http://localhost:11434
# LLM_MODEL=llama3.2
# EMBEDDING_MODEL=nomic-embed-text
# EMBEDDING_DIMENSIONS=768

# =============================================================================
# Common LLM Settings
# =============================================================================
# Temperature for LLM responses (0.0 = deterministic, 1.0 = creative)
LLM_TEMPERATURE=0.3

# =============================================================================
# Agent Pipeline Configuration
# =============================================================================
# The RAG pipeline uses specialized agents for improved accuracy and reduced
# hallucinations. Each agent can use a different model for cost optimization.

# Query Planner: Classifies intent and extracts entities (fast model recommended)
AGENT_PLANNER_MODEL=gpt-4o-mini

# Data Extractor: Extracts grounded facts from context (capable model recommended)
AGENT_EXTRACTOR_MODEL=gpt-4o

# Response Composer: Formats extracted data into components (capable model recommended)
AGENT_COMPOSER_MODEL=gpt-4o

# Response Verifier: Validates claims against context (fast model recommended)
AGENT_VERIFIER_MODEL=gpt-4o-mini

# Enable/disable the verification step (adds latency but improves accuracy)
AGENT_VERIFIER_ENABLED=true

# Retrieval configuration
AGENT_DEFAULT_TOP_K=10
AGENT_MIN_CHUNKS=3

# =============================================================================
# Redis (cache)
# =============================================================================
REDIS_URL=redis://localhost:6379/0

# =============================================================================
# Vector Store (Qdrant)
# =============================================================================
QDRANT_URL=http://localhost:6333
QDRANT_COLLECTION=democrata_chunks

# =============================================================================
# Blob Storage (local filesystem)
# =============================================================================
BLOB_STORAGE_PATH=./data/blobs

# =============================================================================
# CORS Configuration
# =============================================================================
# Comma-separated list of allowed origins for CORS
CORS_ORIGINS=http://localhost:5173,http://127.0.0.1:5173

# =============================================================================
# Cost Configuration
# =============================================================================
# Margin applied to API costs for pricing display (0.4 = 40%)
COST_MARGIN=0.4

# =============================================================================
# Rate Limiting
# =============================================================================
# Maximum requests per minute per session
RATE_LIMIT_PER_MINUTE=30

# =============================================================================
# API Authentication (optional)
# =============================================================================
# Comma-separated list of API keys for protected routes (e.g., /ingestion)
# If not set, protected routes are accessible without authentication
# API_KEYS=key1,key2,key3

# =============================================================================
# Frontend Configuration
# =============================================================================
# API server URL for the frontend (Vite environment variable)
# VITE_API_URL=http://localhost:8000

# =============================================================================
# Database (PostgreSQL)
# =============================================================================
# For local development, use the docker-compose PostgreSQL service
DATABASE_URL=postgresql://democrata:democrata_dev@localhost:5432/democrata

# =============================================================================
# Supabase Authentication
# =============================================================================
# Get these from your Supabase project settings (Settings > API)
# For production, use your hosted Supabase project
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_KEY=your-service-key

# JWT secret for validating tokens (Settings > API > JWT Settings)
# SUPABASE_JWT_SECRET=your-jwt-secret

# =============================================================================
# Stripe Payments
# =============================================================================
# Get these from your Stripe dashboard (Developers > API keys)
# Use test keys for development (sk_test_..., whsec_...)
STRIPE_SECRET_KEY=sk_test_your-stripe-secret-key
STRIPE_WEBHOOK_SECRET=whsec_your-webhook-secret

# Optional: Pre-configured price IDs for credit packs
# STRIPE_PRICE_500=price_...
# STRIPE_PRICE_1000=price_...
# STRIPE_PRICE_2000=price_...
